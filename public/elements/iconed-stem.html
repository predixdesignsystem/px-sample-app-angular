<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../styles/bus-tree-styles.html">

<dom-module id="iconed-stem">
    <template>
        <style include="bus-tree-styles"></style>
        <div id="head" class="stem normal-stem"></div>
        <div id="tail" class="stem normal-stem"></div>
    </template>
    
    <script>
        Polymer({
            is: "iconed-stem",
            properties: {
				iconDef: {
					type: Object,
					observer: 'addIcon'
				},
				hasViolations: {
					type: Boolean,
					observer: 'markViolated'
				}			
			},
						
			addIcon: function() {
				if (this.iconDef && this.iconDef.src && this.iconDef.align) {
					var imgNode = document.createElement("img");
					imgNode.setAttribute("class", "stem-icon");
					imgNode.setAttribute("alt", "Image");
					if (this.iconDef.src.length > 0) {
						imgNode.setAttribute("src", this.iconDef.src);
                    }
					if (this.iconDef.align && this.iconDef.align.length > 0) {
                        if (this.iconDef.align == "right") {
                            Polymer.dom(this.root).appendChild(imgNode);
                        } else if (this.iconDef.align == "left") {
                            Polymer.dom(this.root).insertBefore(imgNode, this.$$("#head"));
						} else {
							Polymer.dom(this.root).insertBefore(imgNode, this.$$("#tail"));
						}
                    }
                }
			},
			
			markViolated: function() {
				if (this.hasViolations) {
					this.$.head.classList.remove("normal-stem")
					this.$.tail.classList.remove("normal-stem")
					this.$.head.classList.add("violated-stem")
					this.$.tail.classList.add("violated-stem")
				}
			}
			
		})
    </script>
</dom-module>
